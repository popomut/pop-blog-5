"XSS is one of the popular security risks for applications especially web applications (you can think of it as any websites you are serving). In 2013, XSS was listed on OWASP Top 10 (ranked #3) Application Security Risk.\n\n The reasons I created this article is because I have some friends who quite know what the XSS is, and how to prevent, but when discussing further, some of them still have a hard time to tell how hacker could hack PC’s victim such as ..\n\n- How hacker could stealing session ID from PC’s victim?\n- How script can be run on PC’s victim?\n- What else the script can do?\n\nIf those questions are in your doubt, this article might help. The goal of this article is to make everything simple so that all end-user could understand the risk, and be wary on what could harm them during serving the web (any webs). If you are familiar with XSS, and know the answers already, you may skip or exchange your knowledge with me.\n\n\n**So, what is Cross-site scripting (XSS)?**\n\nFor web applications, it is a Javascript that hacker created specifically for a specific web application, the same script may or may not work for another application/website.\n\nThe important point is that this script will work when user has a active session on a website. If user has logged out from the website, thus there is no active session, the script normally won’t work because the website will not allow user to access the page contains this security hole.\n\nFor websites that do not utilize session (no need to login), it may always works.\n\nFor example, if you have logged in to Facebook, and Facebook has XSS security hole, hacker may lure you to run a Javascript that the hacker created. The script could do various things which will be explained in a separated section. For now let’s say the Javascript will steals your Facebook session ID.\n\n**What is Session ID in web applications**\n\nTalking in general, as a web application user, you will get a session ID when you have logged in to a web application that you are using/serving.\nThe session ID is unique, and maybe a very long string consisting of characters and numbers. You will get a new ID if you logged out and logged in again.\n\n Example: 768rqkgl13rj8307xdt2lAAAg6nt\n\nSession ID is store in a file, we called that “Cookie”. Browser reads Session ID from the cookie file, sends it to web server every time you click link on the web. This way web server knows who you are, thus provide proper services/functions based on what your account can do.\n\n**Why is session ID important**\n\nIf hacker has successfully stolen you session ID, by putting some extra effort to modify cookie file, web request in hacker’s PC, they can access the web application as your account, hacker no need to login at all.\n\n**So, how could hacker steal your session ID**\n\nOne simplest scenario is that..\n\n1. Let’s assume that a hacker has found an XSS security hole on a page in Facebook. Hacker will tell this to no one, but might sell it somewhere for money.\n\n2. Hacker will spend quite a lot of time to craft a URL for DIRECTLY accessing the Facebook page that has XSS security hole, absolutely hacker will embedded a malicious Javascript to the URL. At the end, the URL may look like below (note that URL does not exist, it is just an example I created, in reality Facebook is completely complex).\n\nwww.facebook.com/FriendSearch?searchName=john</div><script>//this is Javascript code to read cookie file and send data in the file to hacker</script>\n\n\n3. Hacker maybe someone you know in your Instant Messaging friends list, Hacker then contacts you and asks you to click on the link for whatever reasons such as “Hey, have you ever tried this new feature in Facebook, it can create a New Year card and share it with friend instantly”.\nAnother scenario might be that hacker puts that URL on a forum/webboard, and just waits for someone to click on it.\n\n4. Once you have clicked, the hacking process is done.\n\n**Now, let’s talk how website/web applications contain the XSS security hole**\n\nSee the diagram as below would give you better understand what would happen.\n1. Let’s say Facebook has XSS hole in Friend Search functionality (again this is an example, this mockup is never exist in Facebook).\n\n2. You clicked on the link above that a hacker convinced you to click on it.\n\n3. Browser is opened, and sends HTTP request to Facebook Application server, that HTTP request contains parameter `“searchName=john</div><script>//this is Javascript code to read cookie file and send data in the file to hacker</script>”`\n\n4. In application server, FriendSearch program accepts HTTP request, do some processing, then process JSP file by simply displaying the search parameter (searchName) on friendSearchResult.jsp, then sends the last outcome which is HTML of search result page to the browser.\n\nnow the HTTP Response contains HTML of search result page which the important part would looks like below, browser processes the HTML code, thus the malicious Javascript code that embedded into the URL will be run.\n\n\n<body>\n<div>john</div> <script>//this is Javascript code to read cookie file and send data in the file to hacker</script> </div>\n..\n..\n</body>\n\n\n![](https://firebasestorage.googleapis.com/v0/b/ng-blog-3d3e9.appspot.com/o/images%2F1_iXg_eIPSK2DpC-O-Eit4MA_1577501802496.png?alt=media&token=fbfca00c-6ef5-43e7-a3f9-e41b2274c1f6)\n\n\n**As a web developer, how do I prevent XSS attacking in my web application?**\n\nGeneral advices would be validate input and output (yes, it is recommend to validate your output as well even though the output is something from your reliable sources such as database).\n\nSome of my applications, I could just simply remove some characters, we called that script characters, for example, “/”, “‘“, “=”, “<”, “>” or even remove “<script>”, the string “<script>” should not be a part of anyone name, right? Well. unless your applications allow that for some business reasons.\n\nFor this example, when FriendSearch.java read value of “searchName”. we should add code to remove “/” and “<” from it. Once they has been removed, the output HTML would looks like below\n\n\n<body>\n<div>johndiv>script>this is Javascript code to read cookie file and send data in the file to hackerscript></div>\n..\n..\n</body>\n\n\nObviously, like you can imagine, the result page will not display properly due to the code does not in HTML properly format, but at least the malicious Javascript will not be run, thus user does not get hurt.\n\nAnother way to take care of this is to “escape” the input character.\n\n**Example of Javascript code to read cookie and send it to a server own by hacker**\n\n- Javascript to read session ID from Cookie\n- Javascript to send session ID back to hacker’s server\n**What else the malicious Javascript could do?**\n\nI have played around BeEF tool (in Kali linux) in order to answer this question.\nI am no expert on this tool, from what I have observed this tool is acting like a server, when user click on a XSS link hacker crafted, this tool will show there is a victim, and hacker could send commands by using the tools to do many things, such as..\n\nIt could dynamically create a sophisticate DIV pop-up that looks like it is a pop-up from Youtube, Google, Facebook to ask user ID/Password. DIV pop-up means that this is a pop-up in your current web page, it is not open a new tab or new window. So this is very smooth pop-up that could convince end-user to enter ID/Password\n\n![](https://firebasestorage.googleapis.com/v0/b/ng-blog-3d3e9.appspot.com/o/images%2F1_oN-LbYF4Oufd0UTHdCAIKw_1577501802497.png?alt=media&token=753348a8-c810-4114-b385-a5d388cdefa7)\n\nIt could gather information, fingerprint, access history.\n\nIt could gather your network information, port scanning, network map, and much more.\n\nAll of this merely user clicks on a link that hacker crafted specifically for a security hole on a web site.\n\n**Conclusion**\n\nWhile it is web developers responsibility to develop reliable applications that has no XSS security hole, as a user, we also need to be mindful when accessing/clicking any links that someone provided, or even it is on a web you trusted. Users have to look in detail on the link whether or not it contains something strange like Javascript code, or it may also include a path pointing to a Javascript file.\n\nToo long link that contains a lot of unreadable characters, I would skip that too.\n\nBe super caution when anything asks you about ID or password as you have seen from my example above, you could see that Javascript could create a DIV pop-up that looks really like it is from Facebook.\n\n\n\n\n\n\n"